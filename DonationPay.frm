VERSION 5.00
Object = "{6BF52A50-394A-11D3-B153-00C04F79FAA6}#1.0#0"; "wmp.dll"
Begin VB.Form DonationPay 
   Caption         =   "Form1"
   ClientHeight    =   8430
   ClientLeft      =   120
   ClientTop       =   450
   ClientWidth     =   12240
   LinkTopic       =   "Form1"
   ScaleHeight     =   562
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   816
   StartUpPosition =   2  'CenterScreen
   Begin VB.CommandButton Command13 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   15.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   5640
      Picture         =   "DonationPay.frx":0000
      Style           =   1  'Graphical
      TabIndex        =   13
      Top             =   5160
      Width           =   1455
   End
   Begin VB.CommandButton Command12 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   15.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   5640
      Picture         =   "DonationPay.frx":3398
      Style           =   1  'Graphical
      TabIndex        =   12
      Top             =   4320
      Width           =   1455
   End
   Begin VB.CommandButton Command11 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   15.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   5640
      Picture         =   "DonationPay.frx":6730
      Style           =   1  'Graphical
      TabIndex        =   11
      Top             =   3480
      Width           =   1455
   End
   Begin VB.CommandButton Command10 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   3600
      Picture         =   "DonationPay.frx":9AC8
      Style           =   1  'Graphical
      TabIndex        =   10
      Top             =   6000
      Width           =   735
   End
   Begin VB.CommandButton Command9 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   4560
      Picture         =   "DonationPay.frx":BD80
      Style           =   1  'Graphical
      TabIndex        =   9
      Top             =   5160
      Width           =   735
   End
   Begin VB.CommandButton Command8 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   3600
      Picture         =   "DonationPay.frx":E038
      Style           =   1  'Graphical
      TabIndex        =   8
      Top             =   5160
      Width           =   735
   End
   Begin VB.CommandButton Command7 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   2640
      Picture         =   "DonationPay.frx":102F0
      Style           =   1  'Graphical
      TabIndex        =   7
      Top             =   5160
      Width           =   735
   End
   Begin VB.CommandButton Command6 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   4560
      Picture         =   "DonationPay.frx":125A8
      Style           =   1  'Graphical
      TabIndex        =   6
      Top             =   4320
      Width           =   735
   End
   Begin VB.CommandButton Command5 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   3600
      Picture         =   "DonationPay.frx":14860
      Style           =   1  'Graphical
      TabIndex        =   5
      Top             =   4320
      Width           =   735
   End
   Begin VB.CommandButton Command4 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   2640
      Picture         =   "DonationPay.frx":16D18
      Style           =   1  'Graphical
      TabIndex        =   4
      Top             =   4320
      Width           =   735
   End
   Begin VB.CommandButton Command3 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   4560
      Picture         =   "DonationPay.frx":18FD0
      Style           =   1  'Graphical
      TabIndex        =   3
      Top             =   3480
      Width           =   735
   End
   Begin VB.CommandButton Command2 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   3600
      Picture         =   "DonationPay.frx":1B288
      Style           =   1  'Graphical
      TabIndex        =   2
      Top             =   3480
      Width           =   735
   End
   Begin VB.CommandButton Command1 
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   675
      Left            =   2640
      Picture         =   "DonationPay.frx":1D540
      Style           =   1  'Graphical
      TabIndex        =   1
      Top             =   3480
      Width           =   735
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Left            =   2520
      TabIndex        =   0
      Top             =   2520
      Width           =   4575
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      BackStyle       =   0  'Transparent
      Caption         =   "ATM"
      BeginProperty Font 
         Name            =   "Trebuchet MS"
         Size            =   36
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H8000000E&
      Height          =   975
      Left            =   5520
      TabIndex        =   15
      Top             =   120
      Width           =   1695
   End
   Begin VB.Image Image2 
      Height          =   1095
      Left            =   3840
      Picture         =   "DonationPay.frx":1EF88
      Stretch         =   -1  'True
      Top             =   0
      Width           =   1935
   End
   Begin WMPLibCtl.WindowsMediaPlayer WindowsMediaPlayer1 
      Height          =   30
      Left            =   6360
      TabIndex        =   14
      Top             =   7200
      Visible         =   0   'False
      Width           =   135
      URL             =   ""
      rate            =   1
      balance         =   0
      currentPosition =   0
      defaultFrame    =   ""
      playCount       =   1
      autoStart       =   -1  'True
      currentMarker   =   0
      invokeURLs      =   -1  'True
      baseURL         =   ""
      volume          =   50
      mute            =   0   'False
      uiMode          =   "full"
      stretchToFit    =   0   'False
      windowlessVideo =   0   'False
      enabled         =   -1  'True
      enableContextMenu=   -1  'True
      fullScreen      =   0   'False
      SAMIStyle       =   ""
      SAMILang        =   ""
      SAMIFilename    =   ""
      captioningID    =   ""
      enableErrorDialogs=   0   'False
      _cx             =   238
      _cy             =   53
   End
   Begin VB.Image Image1 
      Height          =   8415
      Left            =   0
      Picture         =   "DonationPay.frx":256B5
      Stretch         =   -1  'True
      Top             =   0
      Width           =   12255
   End
End
Attribute VB_Name = "DonationPay"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim s1, s2, narr1, narr2, TransType As String
Dim DonationDate As Date
Dim Record As New ADODB.Recordset
Dim Conn As New ADODB.Connection

Private Sub Command1_Click()
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
Text1.Text = Text1.Text + "1"
End Sub

Private Sub Command12_Click()
AtmNumber.restart
DonationPay.Hide
End Sub

Private Sub Command2_Click()
Text1.Text = Text1.Text + "2"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command3_Click()
Text1.Text = Text1.Text + "3"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command4_Click()
Text1.Text = Text1.Text + "4"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command5_Click()
Text1.Text = Text1.Text + "5"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command6_Click()
Text1.Text = Text1.Text + "6"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command7_Click()
Text1.Text = Text1.Text + "7"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command8_Click()
Text1.Text = Text1.Text + "8"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command9_Click()
Text1.Text = Text1.Text + "9"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command10_Click()
Text1.Text = Text1.Text + "0"
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
End Sub
Private Sub Command11_Click()
WindowsMediaPlayer1.URL = "E:\vbProject\converted audio\Windows.wav"
Text1.Text = ""
End Sub

Private Sub Command13_Click()
If AtmNumber.AccountBalance >= 200 And Val(Text1.Text) <= 10000 And (Val(Text1.Text) Mod 100 = 0) And Val(Text1.Text) < AtmNumber.AccountBalance Then

Conn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=E:\vbProject\Database\ATM.mdb;Persist Security Info=False"
AtmNumber.AccountBalance = AtmNumber.AccountBalance - Val(Text1.Text)
s1 = "Update Account set Balance=" & AtmNumber.AccountBalance & " where Acc_No=" & AtmNumber.AccountNo & "  "
s3 = "insert into Trans(T_Type,Acc_No,DOT,Narration,Amount) values('" & TransType & "'," & AtmNumber.AccountNo & ",'" & DonationDate & "','" & narr2 & "'," & Val(Text1.Text) & ")"

If Donation.flag = 1 Then
Services.DonationBalance1 = Services.DonationBalance1 + Val(Text1.Text)
s2 = "Update Account set Balance=" & Services.DonationBalance1 & " where Acc_No=" & 112233405 & " "
s4 = "insert into Trans(T_Type,Acc_No,DOT,Narration,Amount) values('" & TransType & "'," & 112233405 & ",'" & DonationDate & "','" & narr1 & "'," & Val(Text1.Text) & ")"
Record.Open s1, Conn, adOpenDynamic, adLockOptimistic
Record.Open s2, Conn, adOpenDynamic, adLockOptimistic
Record.Open s3, Conn, adOpenDynamic, adLockOptimistic
Record.Open s4, Conn, adOpenDynamic, adLockOptimistic

ElseIf Donation.flag = 2 Then
Services.DonationBalance2 = Services.DonationBalance2 + Val(Text1.Text)
s2 = "Update Account set Balance=" & Services.DonationBalance1 & " where Acc_No=" & 112233406 & " "
s4 = "insert into Trans(T_Type,Acc_No,DOT,Narration,Amount) values('" & TransType & "'," & 112233406 & ",'" & DonationDate & "','" & narr1 & "'," & Val(Text1.Text) & ")"

Record.Open s1, Conn, adOpenDynamic, adLockOptimistic
Record.Open s2, Conn, adOpenDynamic, adLockOptimistic
Record.Open s3, Conn, adOpenDynamic, adLockOptimistic
Record.Open s4, Conn, adOpenDynamic, adLockOptimistic
End If
Else
End If

Conn.Close
PleaseWait.Timer1.Enabled = True
PleaseWait.Timer2.Enabled = True
PleaseWait.Timer3.Enabled = True
PleaseWait.Show
DonationPay.Hide
End Sub

Private Sub Form_Load()
TransType = "Donation"
DonationDate = Format(Now, "dd/mm/yyyy")
narr1 = "Donation + Credited"
narr2 = "Donation - debited"
End Sub
